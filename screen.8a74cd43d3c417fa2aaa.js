(()=>{"use strict";const t="beforeend",e=(t,e)=>{const a=document.createElement(t);return e&&(Array.isArray(e)?e.forEach((t=>a.classList.add(t))):a.classList.add(e)),a},a=(e,a,r="beforeend")=>{switch(r){case"afterbegin":e.prepend(a);break;case t:e.append(a);break;default:throw new Error(`Wrong render position: ${r}`)}};class r{constructor(t,e,a){this.playersUrl=t,this.randomUrl=e,this.fightUrl=a}getCharacters(){return this.load(this.playersUrl,"GET").then(r.toJSON)}getRandomCharacter(){return this.load(this.randomUrl,"GET").then(r.toJSON)}postFight(){return this.load(this.fightUrl,"POST")}load(t,e){return fetch(t,{method:e}).then(r.checkStatus).catch(r.checkError)}static checkStatus(t){if(t.status<200&&t.status>299)throw new Error(`${t.status}: ${t.statusText}`);return t}static toJSON(t){return t.json()}static catchError(){}}const s=document.querySelector(".parent"),h=document.querySelector(".player"),i=new r("https://reactmarathon-api.herokuapp.com/api/mk/players","https://reactmarathon-api.herokuapp.com/api/mk/player/choose","http://reactmarathon-api.herokuapp.com/api/mk/player/fight"),c=new class{constructor(t,e,a){this.$parent=t,this.$player=e,this.api=a,this.character={},this.showedCharacter=null,this.handleCharacterMouseover=this.handleCharacterMouseover.bind(this),this.handleCharacterMouseout=this.handleCharacterMouseout.bind(this),this.handleCharacterClick=this.handleCharacterClick.bind(this)}init(){this.renderEmptyCharacter(),this.api.getCharacters().then((t=>this.renderCharacters(t)))}renderCharacters(t){t.forEach((t=>{const{name:e,id:r,avatar:s}=t,h=e;this.character[r]=t;const i=this.createCharacter({name:e,id:r,avatar:s,alt:h});i.addEventListener("mouseover",this.handleCharacterMouseover),i.addEventListener("click",this.handleCharacterClick),a(this.$parent,i)}))}createCharacter({avatar:t,id:r,alt:s,isDisabled:h}){const i=e("div",["character",`div${r}`]);h&&i.classList.add("disabled"),i.dataset.id=r;const c=e("img");return c.setAttribute("src",t),s&&c.setAttribute("alt",s),a(i,c),i}handleCharacterMouseover(t){"DIV"===t.target.tagName&&(this.showCharacter(t.target.dataset.id),t.target.addEventListener("mouseout",this.handleCharacterMouseout))}showCharacter(t){const{img:r}=this.character[t];this.$showedCharacter||(this.$showedCharacter=e("img"),a(this.$player,this.$showedCharacter)),r!==this.$showedCharacter.src&&this.$showedCharacter.setAttribute("src",r)}renderEmptyCharacter(){const t=this.createCharacter({avatar:"http://reactmarathon-api.herokuapp.com/assets/mk/avatar/11.png",isDisabled:!0,id:11});a(this.$parent,t)}enemyChoose(t){this.enemy=t,this.startGame()}startGame(){localStorage.setItem("player1",JSON.stringify(this.player)),localStorage.setItem("player2",JSON.stringify(this.enemy)),window.location.pathname="/MortalCombat/arenas.html"}handleCharacterClick(t){"DIV"===t.target.tagName&&(t.target.classList.add("active"),this.player=this.character[t.target.dataset.id],document.querySelectorAll(".character").forEach((t=>{t.removeEventListener("click",this.handleCharacterClick),t.removeEventListener("mouseover",this.handleCharacterMouseover)})),this.api.getRandomCharacter().then((t=>this.enemyChoose(t))))}handleCharacterMouseout(t){"DIV"===t.target&&(this.evt.target.removeEventListener("mouseout",this.handleCharacterMouseout),this.$showedCharacter.remove(),this.$showedCharacter=null)}}(s,h,i);c.init()})();
//# sourceMappingURL=screen.8a74cd43d3c417fa2aaa.js.map